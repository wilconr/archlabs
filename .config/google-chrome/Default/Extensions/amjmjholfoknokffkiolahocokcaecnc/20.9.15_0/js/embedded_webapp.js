var openModal,background=chrome.extension.getBackgroundPage(),src=background.hostname;function createIframe(){var e=document.createElement("iframe");e.id="webapp",e.src=src+"/web/app/v2",document.querySelector("article").appendChild(e)}function init(){openModal=!0,setTimeout((function(){$("#close-btn").click((function(){checkCloseable()}))}),500)}function checkCloseable(){openModal=!1,sendToParent({type:"hide_modal"}),sendToChild({type:"confirm_close"})}function sendToChild(e){document.getElementById("webapp").contentWindow.postMessage(e,"*")}function sendToParent(e){parent.postMessage(e,"*")}function getParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null}window.addEventListener("message",(function(e){var n=e.data;!n.type||"close_modal"==n.type&&openModal||("change_modal_status"===n.type&&"undefined"!==n.data?openModal=n.data:"updated_session_cookie"===n.type?chrome.runtime.sendMessage(chrome.runtime.id,n):"check_transferring"===n.type?n.value||openModal?sendToParent(n):sendToParent({type:"close_modal"}):e.source===document.getElementById("webapp").contentWindow?sendToParent(n):sendToChild(n))})),window.onload=function(){createIframe()},document.addEventListener("DOMContentLoaded",(function(){init()}));