var tabId;function getMessage(e,t){return chrome.i18n.getMessage(e)}function getParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null}window.onload=function(){var e=document.getElementById("sa-progress"),t=document.getElementById("progress-container"),n=document.getElementById("sa-close-btn"),s=document.getElementById("sa-link"),a=document.getElementById("copy-noti"),o=document.getElementById("sa-status"),i=document.getElementById("sa-loading");function d(){t.style.display="none"}a.innerHTML=getMessage("noti_copy"),e.style.width="0%",s.style.display="none",chrome.runtime.onMessage.addListener((function(t,n,a){if(n.id==chrome.runtime.id){var l=!1;if("create_key"==t.type)t.data.key,s.innerHTML=t.data.link,i.style.display="none",s.style.display="block",o.style.display="block",a("OK"),l=!0;else if("update_status"==t.type){var r=t.data.total,c=t.data.done;progress=Math.floor(c/r*1e3)/10,e.style.width=progress+"%",progress>=100&&d()}else if("fail_upload"==t.type)i.style.display="none",s.style.display="none",d(),o.innerHTML=getMessage("fail"),o.style.display="block";else{if("login_required"!==t.type)return!1;i.style.display="none",s.style.display="none",d(),o.innerHTML="Login reqiured.",o.style.display="block"}return t.tabId&&(tabId=t.tabId),l||a(),!0}})),n.addEventListener("click",(function(){parent.postMessage("close_iframe","*")})),s.addEventListener("click",(function(){!function(e){var t=$("<textarea/>");t.text(e),$("body").append(t),t.select();var n=document.execCommand("copy");t.remove(),n&&(a.style.display="block",setTimeout((function(){a.style.display="none"}),1200))}(this.innerHTML)}))},chrome.runtime.sendMessage(chrome.runtime.id,{type:"get_tab_id"},(function(e){tabId=e.tabId}));